{% trans_default_domain 'cocorico_listing' %}

<h2>{{ 'listing.similaries.heading'|trans }}</h2>

<!-- post -->
{%- for result in results.getIterator() -%}
    {% set listing = result[0] %}
    {% set listing_translation = listing.translations[app.request.locale] %}
    {% set price = listing.price | format_price(app.request.locale, 0) %}
    {% set listing_image = listing.images|length ? listing.images[0].name : ListingImageConstants.IMAGE_DEFAULT %}
    {% set listing_location = listing.location %}
    {% set listing_user = listing.user %}
    {% set user_image = listing_user.images|length ? listing_user.images[0].name : UserImageConstants.IMAGE_DEFAULT %}

    <article class="listing-post col-sm-6 col-xs-12" data-lid="{{ listing.id }}">
        <a href="javascript:void(0);" id="favourite-{{ listing.id }}" class="favourit">
            <i class="icon-heart"></i>
            <span class="hidden">favourit</span>
        </a>
        <a href="{{ path('cocorico_listing_show', { 'slug': listing_translation.slug }) }}" class="listing-box">
            <div class="frame">
                <div class="post-info">
                    <div class="img-holder">
                        <img alt="{{ listing_translation.title }}"
                             src="{{ (ListingImageConstants.IMAGE_FOLDER ~ listing_image) | imagine_filter('listing_large') }}">
                    </div>
                    <div class="box">
                        <div class="box-holder">
                            <div class="head">
                                <div class="time-price">
                                    <strong class="price">{{ price }}<p>{{ vatInclusionText(app.request.getLocale()) }}/{{ (0)|add_time_unit_text }}</p></strong>
                                </div>
                            </div>
                            <div class="foot">
                                <div class="area">
                                    {% if listing.averageRating %}
                                        {{ listing.averageRating | cocorico_star_rating }}
                                    {% endif %}
                                </div>
                                <strong class="title">{{ listing_translation.description | strip_private_info | truncate(45) }}</strong>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="post-content">
                    <div class="alignleft">
                        <img src="{{ (UserImageConstants.IMAGE_FOLDER ~ user_image) | imagine_filter('user_xsmall') }}"
                             alt="{{ listing_user.firstName }}"/>
                    </div>
                    <div class="textbox">
                        <h2>{{ listing_translation.title }}</h2>
                        <p>{{ listing_location.city }} </p>
                    </div>
                </div>
            </div>
        </a>

    </article>
{% endfor %}

{% if ('search_result?location' in app.request.headers.get('referer')) or ('resultat-recherche?location' in app.request.headers.get('referer')) %}
    {% set referer = app.request.headers.get('referer') %}
{% else %}
    {% set referer = path('cocorico_listing_search_result') %}
{% endif %}
<a class="btn btn-default" href="{{ referer }}">{{ 'listing.similaries.back_to_search'|trans }}</a>
